# FPGA LVDS ‚Üí FIFO ‚Üí FT601 Data Capture

–ü—Ä–æ–µ–∫—Ç Verilog-–¥–∏–∑–∞–π–Ω–∞ –¥–ª—è –ü–õ–ò–° **Xilinx Spartan-6** (–ø–ª–∞—Ç–∞ **CallistoS6**), –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –ø—Ä–∏—ë–º–∞ –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ GPIO (LVDS), –∏—Ö –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –ø–æ—Å–ª–µ–¥—É—é—â–µ–π –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞ –ü–ö —á–µ—Ä–µ–∑ **FTDI FT601** –≤ —Ä–µ–∂–∏–º–µ **245 Synchronous FIFO**.

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Å –ø—Ä–∏—Ü–µ–ª–æ–º –Ω–∞ –¥–∞–ª—å–Ω–µ–π—à—É—é –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –ü–ö –≤ –≤–∏–¥–µ **–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–∞**. –¢—Ä–µ–±—É—é—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ—Å—Ç–±–µ–Ω—á–∞, –∞ –≤–ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–µ –∏ –¥–∏–∑–∞–π–Ω–∞, —Ç–∞–∫–∂–µ —Ñ–∞–π–ª –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∏ –±—É–¥–µ—Ç –∏–∑–º–µ–Ω–µ–Ω.

---

## –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (Data Pipeline)

–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –≤ –ø—Ä–æ–µ–∫—Ç–µ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
GPIO (LVDS) ‚Üí LVDS input buffers ‚Üí packer8to32 ‚Üí async FIFO (fifo_dualport + sram_dp) ‚Üí fifo_fsm ‚Üí FT601 ‚Üí –ü–ö (–∑–∞–ø–∏—Å—å / –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö)
<img width="1015" height="730" alt="image" src="https://github.com/user-attachments/assets/aaaa4bfa-6859-4b87-a22b-f7adaf297dc1" />

–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ö–µ–º—ã —Å–¥–µ–ª–∞–Ω–æ –≤ Xilinx ISE, –≤ –±—É–¥—É—â–µ–º –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å –±–æ–ª–µ–µ –ø–æ–Ω—è—Ç–Ω—É—é –±–ª–æ–∫ —Å—Ö–µ–º—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –º–æ–¥—É–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

---

## –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (LVDS)

- –î–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—É–ø–∞—é—Ç –Ω–∞ GPIO-–ø–∏–Ω—ã –ü–õ–ò–° –≤ –≤–∏–¥–µ:
  - 8-–±–∏—Ç–Ω–æ–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π —à–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö
  - –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ç–∞–∫—Ç–æ–≤–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
  - –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ —Å—Ç—Ä–æ–±–∞ (valid)
  - —Ñ–æ—Ä–º–∞—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö: –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ 0xFF –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø–∞—É–∑–∞, –∫–æ—Ç–æ—Ä–∞—è –¥–ª–∏—Ç—Å—è 16 –±–∞–π—Ç–æ–≤, –∞ –∏–º–µ–Ω–Ω–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å FF000000FF000000FF000000FF000000.
    –¢–æ–≥–¥–∞ —Å—Ç—Ä–æ–± –æ–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ 0 –Ω–∞ –≤—Ä–µ–º—è –ø–∞—É–∑—ã, –≥–æ–≤–æ—Ä—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –≤–∞–ª–∏–¥–Ω—ã, –∏–Ω–∞—á–µ —Å—Ç—Ä–æ–± —Ä–∞–≤–µ–Ω 1, —Ç–æ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ –≤–∞–ª–∏–¥–Ω—ã. –î–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏
    —Å—Ç—Ä–æ–±–µ —Ä–∞–≤–Ω–æ–º 1  
- –í –º–æ–¥—É–ª–µ `LVDS.v` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤—Ö–æ–¥–Ω—ã–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –±—É—Ñ–µ—Ä—ã `IBUFDS`
- –î–∞–Ω–Ω—ã–µ –∏ —Å—Ç—Ä–æ–± **—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –ø–æ —Å–ø–∞–¥–∞—é—â–µ–º—É —Ñ—Ä–æ–Ω—Ç—É –≤—Ö–æ–¥–Ω–æ–≥–æ —Ç–∞–∫—Ç–∞**, —á—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏—Ö —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å

---

## –£–ø–∞–∫–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (`packer8to32.v`)

- –ü—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º `valid_in` –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è 8-–±–∏—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ö–∞–∂–¥—ã–µ 4 –±–∞–π—Ç–∞ —É–ø–∞–∫–æ–≤—ã–≤–∞—é—Ç—Å—è –≤ –æ–¥–Ω–æ 32-–±–∏—Ç–Ω–æ–µ —Å–ª–æ–≤–æ
- –ü–æ—Ä—è–¥–æ–∫ —É–ø–∞–∫–æ–≤–∫–∏ –±–∞–π—Ç–æ–≤:

byte0 ‚Üí [7:0]
byte1 ‚Üí [15:8]
byte2 ‚Üí [23:16]
byte3 ‚Üí [31:24]

- –°–∏–≥–Ω–∞–ª `valid_out` —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª–Ω–æ–≥–æ 32-–±–∏—Ç–Ω–æ–≥–æ —Å–ª–æ–≤–∞**

---

## –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (FIFO + SRAM)

### `fifo_dualport.v`

- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π FIFO —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∞–∫—Ç–æ–≤—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏:
  - –¥–æ–º–µ–Ω –∑–∞–ø–∏—Å–∏: LVDS (`ClockOUT`)
  - –¥–æ–º–µ–Ω —á—Ç–µ–Ω–∏—è: FT601
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:
  - –±–∏–Ω–∞—Ä–Ω—ã–µ –∏ Gray-—É–∫–∞–∑–∞—Ç–µ–ª–∏
  - –¥–≤—É—Ö—Ç–∞–∫—Ç–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —É–∫–∞–∑–∞—Ç–µ–ª–µ–π –º–µ–∂–¥—É –¥–æ–º–µ–Ω–∞–º–∏
- –§–æ—Ä–º–∏—Ä—É—é—Ç—Å—è —Ñ–ª–∞–≥–∏ `full` –∏ `empty`

### `sram_dp.v`

- –î–≤—É—Ö–ø–æ—Ä—Ç–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –ø–∞–º—è—Ç—å
- –†–∞–∑–¥–µ–ª—å–Ω—ã–µ —Ç–∞–∫—Ç—ã –∑–∞–ø–∏—Å–∏ –∏ —á—Ç–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ FIFO

---

## FSM –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ FT601 (`fifo_fsm.v`)

- –£–ø—Ä–∞–≤–ª—è–µ—Ç —Å–∏–≥–Ω–∞–ª–∞–º–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ FT601:
  - `WR_N`, `RD_N`, `OE_N`
  - –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º —à–∏–Ω—ã –¥–∞–Ω–Ω—ã—Ö (`drive_tx`)
- –†–µ–∞–ª–∏–∑—É–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –¥–∞—Ç–∞—à–∏—Ç–æ–º FT601  
  (—Ä–µ–∂–∏–º **245 Synchronous FIFO**)

  <img src="https://github.com/user-attachments/assets/aeb2b4b5-2fa2-40e7-abc7-b04964531911" alt="–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">

*–†–µ–∂–∏–º –∑–∞–ø–∏—Å–∏ –≤ FIFO FT601.*

<img src="https://github.com/user-attachments/assets/09c18ff0-e0dd-4943-9055-3c34a6d38462" alt="–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">

*–†–µ–∂–∏–º —á—Ç–µ–Ω–∏—è –≤ FIFO FT601.*

- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:
  - –ø–µ—Ä–µ–¥–∞—á—É –¥–∞–Ω–Ω—ã—Ö —Å –ü–õ–ò–° –Ω–∞ –ü–ö
  - –ø—Ä–∏—ë–º —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —Å–ª–æ–≤ —Å –ü–ö (START / STOP)

---

## –¢–µ—Å—Ç–±–µ–Ω—á (`lvds_tb.v`)

–¢–µ—Å—Ç–±–µ–Ω—á —Ä–µ–∞–ª–∏–∑—É–µ—Ç **–ø–æ—à–∞–≥–æ–≤—É—é –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é datapipeline**.

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ç–µ—Å—Ç–±–µ–Ω—á–∞:
- –ß—Ç–µ–Ω–∏–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ñ–∞–π–ª–æ–≤ `data_p` –∏ `data_n`
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—É–∑ –ø–µ—Ä–µ–¥–∞—á–∏:
  - –ø–∞—É–∑–∞ = `PAUSE_LEN` –±–∞–π—Ç–æ–≤, –Ω–∞—á–∞–ª–æ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ—Ç–æ—Ä—ã—Ö —è–≤–ª—è–µ—Ç—Å—è `0xFF`
  - –≤–æ –≤—Ä–µ–º—è –ø–∞—É–∑—ã `strobe = 0`
- –ü—Ä–æ–≤–µ—Ä–∫–∞:
  - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ LVDS-–ø—Ä–∏—ë–º–∞
  - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏ 8‚Üí32 –±–∏—Ç
  - (–Ω–∞ —Å–ª–µ–¥—É—é—â–µ–º —ç—Ç–∞–ø–µ) FIFO + SRAM
- –¢–µ—Å—Ç–±–µ–Ω—á –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ `task`-–∞—Ö, —á—Ç–æ —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–µ –º–æ–¥—É–ª–∏

<img src="https://github.com/user-attachments/assets/b0d7f6e2-dcbd-4bf3-92a7-9e430a089b93" alt="–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
  
*–°–∫—Ä–∏–Ω—à–æ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã LVDS-–ø—Ä–∏–µ–º–∞ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —É–ø–∞–∫–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö 8‚Üí32 –±–∏—Ç.*

<img src="https://github.com/user-attachments/assets/4fbb9aa5-25ef-4625-862d-05e7645d4f6a" alt="–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">

*–°–∫—Ä–∏–Ω—à–æ—Ç –ø–æ–ª–Ω–æ–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –¥–∏–∞–≥—Ä–∞–º–º—ã. –ö–∞–∫ –≤–∏–¥–Ω–æ –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–µ, strob_out –≤ –æ–ø—Ä–µ–¥–µ–ª–Ω–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –≤—Ä–µ–º–µ–Ω–∏, –∫–æ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–π—Ç–æ–≤, –æ–±–æ–∑–Ω–∞—á–∞—é—â–∞—è –ø–∞—É–∑—É, –æ–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ 0.*


---

## –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

- ‚úÖ LVDS-–ø—Ä–∏—ë–º –∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –£–ø–∞–∫–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö 8 ‚Üí 32 –±–∏—Ç
- ‚úÖ –¢–µ—Å—Ç–±–µ–Ω—á —Å —Ñ–∞–π–ª–æ–≤—ã–º –≤–≤–æ–¥–æ–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–∞—É–∑
- üîÑ –í –ø—Ä–æ—Ü–µ—Å—Å–µ: –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è FIFO + SRAM
- üîú –î–∞–ª–µ–µ: –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ FT601 FSM

---

## –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

- –ü–õ–ò–°: **Xilinx Spartan-6**
- –ü–ª–∞—Ç–∞: **CallistoS6**
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å USB: **FTDI FT601**
- –Ø–∑—ã–∫ –æ–ø–∏—Å–∞–Ω–∏—è: **Verilog HDL**
- –°–∏–º—É–ª—è—Ü–∏—è: **ISim**

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

–ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ—ç—Ç–∞–ø–Ω–æ —Å –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞:
- –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É –º–µ–∂–¥—É —Ç–∞–∫—Ç–æ–≤—ã–º–∏ –¥–æ–º–µ–Ω–∞–º–∏
- —Å—Ç—Ä–æ–≥—É—é –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –ø–æ—Ä—è–¥–∫–∞ –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
- —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤—Ä–µ–º–µ–Ω–Ω—ã–º –¥–∏–∞–≥—Ä–∞–º–º–∞–º FT601
